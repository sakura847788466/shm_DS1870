webpackJsonp([11],{"5pMQ":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("BO1k"),r=a.n(n),i=a("Xxa5"),s=a.n(i),u=a("exGp"),l=a.n(u),o=a("gyMJ"),c=a("vPHJ"),p={name:"PrintRecord",components:{MyPopover:a("5789").a},mounted:function(){var t=this;Object(o.l)().then(function(e){for(var a=0;a<e.data.length;a++)t.printData.push({id:a+1,number:e.data[a].number,allCount:e.data[a].allCount,loading:!1});t.printDataNumber=t.printData.slice(0,t.pageNum)}).catch(function(t){console.log(t)})},data:function(){return{printData:[],printDataNumber:[],currentPage:1,pageNum:10,numberData:[],backNumberData:[],search:"",printNumber:"",loading:!1,tab:!0,printDate:"",customList:[{name:"失败次数",state:!0,value:"failureCount"},{name:"成功次数",state:!0,value:"successCount"},{name:"总次数",state:!0,value:"allCount"}],custom:{successCount:!0,failureCount:!0,allCount:!0}}},methods:{myMessage:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3;this.$message({message:e,type:t,duration:a,showClose:!0,offset:54})},handleFinder:function(t){var e=this;return l()(s.a.mark(function a(){var n;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e.printDataNumber[t.id-1].loading=!0,a.next=3,Object(o.s)(t.number);case 3:0==(n=a.sent).code?(n.data.forEach(function(t){t.total=t.failureCount+t.successCount,Object(c.b)(t.date).then(function(e){t.date=e})}),e.numberData=n.data,e.backNumberData=n.data,e.printNumber=t.number,setTimeout(function(){e.tab=!1,e.printDataNumber[t.id-1].loading=!1},300)):e.myMessage("error","打印记录读取失败");case 5:case"end":return a.stop()}},a,e)}))()},back:function(){this.tab=!0,this.printDate=null,this.printDateOne=""},handleChange:function(t){this.printDataNumber=this.printData.slice(0,t)},handleCurrentChange:function(t){var e=this.pageNum*t,a=e-this.pageNum;this.printDataNumber=[],this.printDataNumber=this.printData.slice(a,e),this.search=""},selectPrintData:function(t){var e=this;return l()(s.a.mark(function a(){var n;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(null!=t){a.next=4;break}return e.numberData=[],e.numberData=e.backNumberData,a.abrupt("return");case 4:n={number:e.printNumber,startdate:e.printDate[0],enddate:e.printDate[1]},Object(o.D)(n).then(function(t){var a=function(t){t.total=t.failureCount+t.successCount,Object(c.b)(t.date).then(function(e){t.date=e})},n=!0,i=!1,s=void 0;try{for(var u,l=r()(t.data);!(n=(u=l.next()).done);n=!0){a(u.value)}}catch(t){i=!0,s=t}finally{try{!n&&l.return&&l.return()}finally{if(i)throw s}}e.numberData=t.data}).catch(function(t){e.numberData=[],e.myMessage("error","当前日期区间没有打印记录")});case 6:case"end":return a.stop()}},a,e)}))()},defaultFun:function(t){this.custom={};var e=!0,a=!1,n=void 0;try{for(var i,s=r()(t);!(e=(i=s.next()).done);e=!0){var u=i.value;this.custom[u.value]=u.state}}catch(t){a=!0,n=t}finally{try{!e&&s.return&&s.return()}finally{if(a)throw n}}},confirmFun:function(t){this.custom={};var e=!0,a=!1,n=void 0;try{for(var i,s=r()(t);!(e=(i=s.next()).done);e=!0){var u=i.value;this.custom[u.value]=u.state}}catch(t){a=!0,n=t}finally{try{!e&&s.return&&s.return()}finally{if(a)throw n}}this.customList=t},closeCustom:function(t){this.customList=[],this.customList=t}}},d={render:function(){var t=this,e=this,a=e.$createElement,n=e._self._c||a;return n("div",{staticClass:"right"},[n("div",{staticClass:"box"},[e.tab?n("div",{staticClass:"title"},[n("span",[e._v("打印记录")]),e._v(" "),n("el-input",{staticStyle:{width:"250px",height:"100%"},attrs:{placeholder:"请输入number号搜索","suffix-icon":"el-icon-search"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1):n("div",{staticClass:"title"},[n("div",{staticStyle:{display:"flex","align-items":"center"}},[n("span",{staticStyle:{"margin-right":"40px"}},[e._v("打印记录")]),e._v(" "),n("MyPopover",{attrs:{"custom-list":e.customList},on:{defaultFun:e.defaultFun,confirmFun:e.confirmFun,closeCustom:e.closeCustom}})],1),e._v(" "),n("el-button",{staticStyle:{height:"32px",width:"60px",padding:"0"},attrs:{type:"danger"},on:{click:e.back}},[e._v("返回")])],1),e._v(" "),n("div",{staticClass:"body"},[n("el-table",{directives:[{name:"show",rawName:"v-show",value:e.tab,expression:"tab"}],staticStyle:{width:"100%",height:"578px",color:"#999","font-size":"16px"},attrs:{"header-row-style":{color:"#666;"},"max-height":"578","row-class-name":"table-row",data:e.printDataNumber.filter(function(e){return!t.search||e.number.toLowerCase().includes(t.search.toLowerCase())})}},[n("el-table-column",{attrs:{label:"序号",prop:"id",width:"210"}}),e._v(" "),n("el-table-column",{attrs:{label:"打印机编号",prop:"number",width:"210"}}),e._v(" "),n("el-table-column",{attrs:{label:"打印总数",prop:"allCount",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{label:"操作",align:"center",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"primary",loading:t.row.loading,size:"small"},on:{click:function(a){return e.handleFinder(t.row)}}},[e._v("\n              查看更多\n            ")])]}}])})],1),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.tab,expression:"tab"}],staticClass:"pagination"},[n("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":e.pageNum,layout:"prev, pager, next, jumper",total:e.printData.length},on:{handleChange:e.handleChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}}),e._v(" "),n("span",{staticStyle:{"margin-left":"18px"}},[e._v("每页显示行数：")]),e._v(" "),n("el-input-number",{staticStyle:{width:"110px"},attrs:{size:"mini",min:1,label:"描述文字"},on:{change:e.handleChange},model:{value:e.pageNum,callback:function(t){e.pageNum=t},expression:"pageNum"}})],1),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!e.tab,expression:"!tab"}]},[n("div",{staticClass:"date-nav"},[n("p",[e._v("当前打印机："+e._s(e.printNumber))]),e._v(" "),n("el-date-picker",{attrs:{editable:!1,type:"daterange","range-separator":"至","value-format":"yyyyMMdd","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.selectPrintData},model:{value:e.printDate,callback:function(t){e.printDate=t},expression:"printDate"}})],1),e._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{"show-summary":"",data:e.numberData,"max-height":"525"}},[n("el-table-column",{attrs:{prop:"date",label:"日期"}}),e._v(" "),e.custom.failureCount?n("el-table-column",{attrs:{align:"center",prop:"failureCount",label:"打印失败次数"}}):e._e(),e._v(" "),e.custom.successCount?n("el-table-column",{attrs:{align:"center",prop:"successCount",label:"打印成功次数"}}):e._e(),e._v(" "),e.custom.allCount?n("el-table-column",{attrs:{align:"center",label:"打印总次数",prop:"total"}}):e._e()],1)],1)],1)])])},staticRenderFns:[]};var m=a("VU/8")(p,d,!1,function(t){a("H9Zl")},"data-v-1c8ec461",null);e.default=m.exports},H9Zl:function(t,e){}});