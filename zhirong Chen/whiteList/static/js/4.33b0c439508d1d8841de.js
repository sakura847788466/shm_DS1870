webpackJsonp([4],{"+Oz+":function(e,t){},"5zde":function(e,t,a){a("zQR9"),a("qyJz"),e.exports=a("FeBl").Array.from},Gu7T:function(e,t,a){"use strict";t.__esModule=!0;var n,r=a("c/Tr"),i=(n=r)&&n.__esModule?n:{default:n};t.default=function(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return(0,i.default)(e)}},"c/Tr":function(e,t,a){e.exports={default:a("5zde"),__esModule:!0}},fBQ2:function(e,t,a){"use strict";var n=a("evD5"),r=a("X8DO");e.exports=function(e,t,a){t in e?n.f(e,t,r(0,a)):e[t]=a}},qyJz:function(e,t,a){"use strict";var n=a("+ZMJ"),r=a("kM2E"),i=a("sB3e"),l=a("msXi"),s=a("Mhyx"),o=a("QRG4"),c=a("fBQ2"),u=a("3fs2");r(r.S+r.F*!a("dY0y")(function(e){Array.from(e)}),"Array",{from:function(e){var t,a,r,m,f=i(e),h="function"==typeof this?this:Array,p=arguments.length,d=p>1?arguments[1]:void 0,v=void 0!==d,g=0,w=u(f);if(v&&(d=n(d,p>2?arguments[2]:void 0,2)),void 0==w||h==Array&&s(w))for(a=new h(t=o(f.length));t>g;g++)c(a,g,v?d(f[g],g):f[g]);else for(m=w.call(f),a=new h;!(r=m.next()).done;g++)c(a,g,v?l(m,d,[r.value,g],!0):r.value);return a.length=g,a}})},v1lr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("BO1k"),r=a.n(n),i=a("Gu7T"),l=a.n(i),s=a("gyMJ"),o=a("5789"),c=a("vPHJ"),u={name:"Firmware",mounted:function(){var e=this;Object(s.q)().then(function(t){for(var a=0;a<t.data.length;a++)t.data[a].id=a+1,t.data[a].type="force",t.data[a].time="",t.data[a].state=!1,t.data[a].wifiFirmwareVersion=Object(c.g)(t.data[a].wifiFirmwareVersion);e.firmwareInfoData=t.data,e.firmwareInfo=e.firmwareInfoData.slice(0,e.pageNum)}).catch(function(e){console.log(e)})},data:function(){return{search:"",firmwareData:"",firmwareInfo:[],multipleSelection:[],isIndeterminate:!1,checkAll:!1,allType:"force",allTime:"",lastTime1:0,lastTime2:0,pageNum:10,currentPage:1,firmwareInfoData:[],isCustom:!1,customList:[{name:"打印机编号",state:!0,value:"number"},{name:"版本号",state:!0,value:"wifiFirmwareVersion"},{name:"IP",state:!0,value:"ip"},{name:"操作",state:!0,value:"handle"},{name:"升级模式",state:!0,value:"pattern"}],custom:{number:!0,ip:!0,handle:!0,pattern:!0,wifiFirmwareVersion:!0}}},methods:{request:function(e,t,a){var n=e.target.files[0];if(/(.ota|.bin)$/.test(n.name)){"all"!=a&&(this.firmwareInfo[t.id-1].firmwareName=n.name);var r=new FileReader,i=this;r.onload=function(e){var n=e.target.result.split(",");"all"!=a?i.handleFinder(t,n[1]):i.batchUpgradeFirmware(n[1])},r.readAsDataURL(n)}else this.$message({type:"error",message:"文件类型有误",duration:3e3,showClose:!0})},handleFinder:function(e,t){var a=this,n={number:e.number,data:t,type:e.type};"wecut"===e.type?(n.timeStr=e.time,Object(s.I)(n).then(function(e){a.$message({type:"success",message:"定时升级固件任务建立成功",duration:3e3,showClose:!0})}).catch(function(e){a.$message({type:"error",message:e.data,duration:3e3,showClose:!0})})):Object(s.I)(n).then(function(e){a.$message({type:"success",message:"固件正在升级",duration:3e3,showClose:!0})}).catch(function(e){a.$message({type:"error",message:e.data,duration:3e3,showClose:!0})})},oneSelect:function(e,t){if(t)this.firmwareInfo[e].state=!0,this.multipleSelection.push(this.firmwareInfo[e]),this.checkAll=this.multipleSelection.length===this.firmwareInfo.length,this.isIndeterminate=this.multipleSelection.length<this.firmwareInfo.length&&0!=this.multipleSelection.length;else{for(var a=this.firmwareInfo[e].number,n=0;n<this.multipleSelection.length;n++)a===this.multipleSelection[n].number&&this.multipleSelection.splice(n,1);this.isIndeterminate=this.multipleSelection.length<this.firmwareInfo.length&&0!=this.multipleSelection.length,this.checkAll=0===this.multipleSelection.length}},handleCheckAllChange:function(e){if(e){for(var t=0;t<this.firmwareInfo.length;t++)this.firmwareInfo[t].state=!0;this.multipleSelection=[],this.multipleSelection=[].concat(l()(this.firmwareInfo)),this.isIndeterminate=!1}else{for(var a=0;a<this.firmwareInfo.length;a++)this.firmwareInfo[a].state=!1;this.multipleSelection=[],this.isIndeterminate=!1}},batchUpgradeFirmware:function(e){var t=this,a=this.multipleSelection;if(a.length>0)if("wecut"===this.allType)for(var n=function(n){var r={number:a[n].number,data:e,type:t.allType,timeStr:t.allTime};Object(s.I)(r).then(function(e){t.$message({type:"success",message:"批量定时升级固件任务建立成功",duration:3e3,showClose:!0})}).catch(function(e){t.$message({type:"error",message:r.number+e.data,duration:3e3,showClose:!0})})},r=0;r<a.length;r++)n(r);else{var i=function(n){var r={number:a[n].number,data:e,type:t.allType};Object(s.I)(r).then(function(e){t.$message({type:"success",message:"批量升级开始",duration:3e3,showClose:!0})}).catch(function(e){t.$message({type:"error",message:r.number+e.data,duration:3e3,showClose:!0})})};for(r=0;r<a.length;r++)i(r)}else this.$message({type:"error",message:"请选择要升级的打印机",duration:3e3,showClose:!0})},setTime:function(e,t){"wecut"!==t.type&&(this.firmwareInfo[e].time="")},timeOut:function(e){var t=Date.now();return t-this.lastTime1<2e3?(console.log(1),this[e]=t,!1):(this[e]=t,!0)},handleChange:function(e){this.firmwareInfo=this.firmwareInfoData.slice(0,e)},handleCurrentChange:function(e){this.multipleSelection=[],this.checkAll=!1;for(var t=0;t<this.firmwareInfo.length;t++)this.firmwareInfo[t].state=!1;var a=this.pageNum*e,n=a-this.pageNum;this.firmwareInfo=[],this.firmwareInfo=this.firmwareInfoData.slice(n,a)},defaultFun:function(e){this.custom={};var t=!0,a=!1,n=void 0;try{for(var i,l=r()(e);!(t=(i=l.next()).done);t=!0){var s=i.value;this.custom[s.value]=s.state}}catch(e){a=!0,n=e}finally{try{!t&&l.return&&l.return()}finally{if(a)throw n}}},confirmFun:function(e){this.custom={};var t=!0,a=!1,n=void 0;try{for(var i,l=r()(e);!(t=(i=l.next()).done);t=!0){var s=i.value;this.custom[s.value]=s.state}}catch(e){a=!0,n=e}finally{try{!t&&l.return&&l.return()}finally{if(a)throw n}}this.customList=e},closeCustom:function(e){this.customList=[],this.customList=e}},components:{MyPopover:o.a}},m={render:function(){var e=this,t=this,a=t.$createElement,n=t._self._c||a;return n("div",{staticClass:"right"},[n("div",{staticClass:"box"},[n("div",{staticClass:"title"},[n("div",{staticStyle:{display:"flex"}},[n("span",{staticStyle:{"margin-right":"40px"}},[t._v("固件升级")]),t._v(" "),n("MyPopover",{attrs:{"custom-list":t.customList},on:{defaultFun:t.defaultFun,confirmFun:t.confirmFun,closeCustom:t.closeCustom}})],1),t._v(" "),n("el-input",{staticStyle:{width:"250px",height:"100%"},attrs:{placeholder:"请输入number号搜索","suffix-icon":"el-icon-search"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),t._v(" "),n("div",{staticClass:"body"},[n("el-table",{ref:"multipleTable",staticStyle:{width:"100%",height:"558px"},attrs:{data:t.firmwareInfo.filter(function(t){return!e.search||t.number.toLowerCase().includes(e.search.toLowerCase())}),"max-height":"558"}},[n("el-table-column",{attrs:{width:"100"},scopedSlots:t._u([{key:"header",fn:function(e){return[n("el-checkbox",{attrs:{indeterminate:t.isIndeterminate},on:{change:t.handleCheckAllChange},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}})]}},{key:"default",fn:function(e){return[n("el-checkbox",{on:{change:function(a){return t.oneSelect(e.$index,e.row.state)}},model:{value:e.row.state,callback:function(a){t.$set(e.row,"state",a)},expression:"scope.row.state"}})]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"序号",prop:"id",width:"100"}}),t._v(" "),t.custom.number?n("el-table-column",{attrs:{label:"打印机编号",prop:"number"}}):t._e(),t._v(" "),t.custom.wifiFirmwareVersion?n("el-table-column",{attrs:{label:"版本号",prop:"wifiFirmwareVersion"}}):t._e(),t._v(" "),t.custom.ip?n("el-table-column",{attrs:{label:"IP",prop:"ipsString"}}):t._e(),t._v(" "),t.custom.pattern?n("el-table-column",{attrs:{label:"升级模式",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择",size:"small"},on:{change:function(a){return t.setTime(e.row.id-1,e.row)}},model:{value:e.row.type,callback:function(a){t.$set(e.row,"type",a)},expression:"scope.row.type"}},[n("el-option",{attrs:{value:"wecut",label:"定时模式"}}),t._v(" "),n("el-option",{attrs:{value:"force",label:"强制模式"}}),t._v(" "),n("el-option",{attrs:{value:"free",label:"智能模式"}})],1)]}}],null,!1,2907560160)}):t._e(),t._v(" "),t.custom.pattern?n("el-table-column",{attrs:{label:"定时时间",width:"240"},scopedSlots:t._u([{key:"default",fn:function(e){return"wecut"===e.row.type?[n("el-date-picker",{staticStyle:{width:"190px"},attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",size:"small",placeholder:"选择日期时间"},model:{value:e.row.time,callback:function(a){t.$set(e.row,"time",a)},expression:"scope.row.time"}})]:void 0}}],null,!0)}):t._e(),t._v(" "),t.custom.handle?n("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("input",{staticStyle:{display:"none"},attrs:{id:e.row.id,type:"file"},on:{change:function(a){return t.request(a,e.row,"noAll")}}}),t._v(" "),n("label",{staticClass:"btn one-btn",attrs:{slot:"reference",for:e.row.id,title:"请导入.ota文件"},slot:"reference"},[t._v("\n              升级\n            ")])]}}],null,!1,2161864449)}):t._e()],1)],1),t._v(" "),n("div",{staticClass:"pagination"},[n("div",{staticStyle:{display:"flex","align-items":"center"}},[n("input",{staticStyle:{display:"none"},attrs:{id:"allFirmware",type:"file"},on:{change:function(e){return t.request(e,"","all")}}}),t._v(" "),n("label",{staticClass:"btn all-btn",attrs:{for:"allFirmware",title:"请导入.ota文件"}},[t._v("\n          批量升级\n        ")]),t._v(" "),n("el-select",{staticStyle:{width:"110px","margin-right":"10px"},attrs:{placeholder:"请选择",name:"type",size:"small"},model:{value:t.allType,callback:function(e){t.allType=e},expression:"allType"}},[n("el-option",{attrs:{value:"wecut",label:"定时模式"}},[t._v("定时模式\n            "),n("el-popover",{attrs:{placement:"right",width:"50",trigger:"hover","popper-class":"popover",content:"选择定时时间，当到达定时时间时，自动升级"}},[n("i",{class:"wecut"==t.allType?"on-question":"question",attrs:{slot:"reference"},slot:"reference"})])],1),t._v(" "),n("el-option",{attrs:{value:"force",label:"强制模式"}},[t._v("强制模式\n            "),n("el-popover",{attrs:{placement:"right",width:"50",trigger:"hover","popper-class":"popover",content:"无论设备在工作还是空闲，也能立即升级"}},[n("i",{class:"force"==t.allType?"on-question":"question",attrs:{slot:"reference"},slot:"reference"})])],1),t._v(" "),n("el-option",{attrs:{value:"free",label:"智能模式"}},[t._v("智能模式\n            "),n("el-popover",{attrs:{placement:"right",width:"50",trigger:"hover","popper-class":"popover",content:"当设备空闲时，自动升级"}},[n("i",{class:"free"==t.allType?"on-question":"question",attrs:{slot:"reference"},slot:"reference"})])],1)],1),t._v(" "),n("el-date-picker",{directives:[{name:"show",rawName:"v-show",value:"wecut"===t.allType,expression:"allType==='wecut'"}],staticStyle:{width:"200px","margin-right":"18px"},attrs:{type:"datetime",size:"small","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间"},model:{value:t.allTime,callback:function(e){t.allTime=e},expression:"allTime"}})],1),t._v(" "),n("div",{staticStyle:{display:"flex","align-items":"center"}},[n("el-pagination",{attrs:{"current-page":t.currentPage,"page-size":t.pageNum,layout:"prev, pager, next, jumper",total:t.firmwareInfoData.length},on:{handleChange:t.handleChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}}),t._v(" "),n("span",{staticStyle:{"margin-left":"18px"}},[t._v("每页显示行数：")]),t._v(" "),n("el-input-number",{attrs:{size:"mini",min:1,label:"描述文字"},on:{change:t.handleChange},model:{value:t.pageNum,callback:function(e){t.pageNum=e},expression:"pageNum"}})],1)])])])},staticRenderFns:[]};var f=a("VU/8")(u,m,!1,function(e){a("+Oz+")},"data-v-b826c04c",null);t.default=f.exports}});